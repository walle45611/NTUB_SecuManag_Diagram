@startuml

package "Kubernetes Cluster" {
  component "Ingress Controller\n(ingress-nginx)" as Ingress

  package "Namespace: ntub-secumanage" {
    component "Frontend\n(React, TypeScript, TailwindCSS, PWA)" as Frontend

    component "Backend\n(Python, FastAPI)" as Backend

    component "RabbitMQ" as RabbitMQ

    component "MinIO\n(S3 API)" as MinIO

    component "PostgreSQL\n(SQLAlchemy, Alembic)" as Database

    component "Consumer\n(Python Worker)" as Consumer

    component "AI Module\n(Embedding Model, RAG)" as AIModule
  }
}

component "Google SMTP Server" as SMTP

Ingress --> Frontend : "HTTP/HTTPS"
Frontend --> Backend : "REST API"
Backend --> RabbitMQ : "AMQP publish"
Consumer --> RabbitMQ : "AMQP subscribe"
Consumer --> Database : "Read/Write via SQLAlchemy"
Backend --> MinIO : "S3 API calls"
Backend --> Database : "TCP:5432"
Backend --> AIModule : "Send prompt & data / retrieve embeddings"
AIModule --> Database : "Store/Retrieve embeddings & RAG data"
AIModule --> SMTP : "Send notification emails"
SMTP --> Backend : "SMTP API"
RabbitMQ --> Consumer : "AMQP publish/subscribe"
RabbitMQ --> Backend : "AMQP publish/subscribe"

@enduml