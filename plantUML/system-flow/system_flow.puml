@startuml system_flow
start
:使用者登入系統;

:選擇操作模組;

if (操作類型?) then (資產管理)
  if (功能選擇?) then (新增/修改資產)
    :新增/修改資產;
    if (選擇AI評估?) then (是)
      :AI 評估資產價值 (可選);
    endif
    :提交簽核流程;
    if (簽核通過?) then (是)
      :更新資產資料;
      :儲存版本記錄;
    else (否)
      :更新資料狀態為拒絕;
      :儲存版本記錄並退回;
    endif
  else (查看風險力導圖)
    :查看風險力導圖;
    :顯示風險等級 (紅/橙/綠);
  endif
elseif (操作類型?) then (文件管理)
  if (功能選擇?) then (上傳文件)
    :上傳文件;
    :文件儲存至 MinIO;
    :提交文件簽核流程;
    if (簽核通過?) then (是)
      :向量化文件內容;
      :儲存embed向量;
      :儲存版本記錄;
    else (否)
      :儲存版本記錄並退回;
    endif
  else (查看文件摘要)
    :進入document頁面;
    :查看已歸檔文件列表;
    :選擇文件進行AI摘要;
  endif
elseif (操作類型?) then (威脅/弱點管理)
  :新增/修改威脅或弱點;
  :提交簽核流程;
  if (簽核通過?) then (是)
    :更新威脅/弱點資料;
    :儲存版本記錄;
  else (否)
    :儲存版本記錄並退回;
  endif
else (系統設定)
  if (設定類型?) then (使用者權限)
    :管理使用者權限;
    :提交權限變更簽核;
    if (簽核通過?) then (是)
      :更新使用者權限;
    else (否)
      :退回;
    endif
  else (系統參數)
    :配置系統參數;
    :提交參數變更簽核;
    if (簽核通過?) then (是)
      :更新系統參數;
      :儲存版本記錄;
    else (否)
      :儲存版本記錄並退回;
    endif
  endif
endif

:記錄操作日誌;
:更新儀表板數據;

stop
@enduml
