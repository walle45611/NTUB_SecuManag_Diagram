@startuml
autonumber
actor "使用者 (Signer)" as Signer
participant Frontend
participant Backend
queue RabbitMQ
participant Worker
database Database
participant "郵件服務" as Mail

Signer -> Frontend: 核准角色變更
Frontend -> Backend: POST /api/approval/{approval_id}/user/{user_id}/approved
Backend -> RabbitMQ: publish approval.completed.approved (role payload)
Backend --> Frontend: 回傳成功

RabbitMQ -> Worker: deliver message
Worker -> Database: 更新角色/權限 + 四階證明
Worker -> Mail: 寄出簽核通過通知
Worker -> RabbitMQ: 刪除 queue 並 ACK
@enduml
