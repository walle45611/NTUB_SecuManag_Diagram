@startuml

actor User as "使用者"
participant Frontend
participant Backend
participant Database
participant Approval as "核准模組"

User ->> Frontend: 點擊「編輯 ISMS 設定」
Frontend ->> Backend: GET /api/system/asset-setting/
Backend ->> Database: 讀取 isms_setting、變數與自訂欄位設定
Backend -->> Frontend: 回傳設定資料
Frontend ->> Frontend: 顯示編輯表單 (名稱、描述、策略值、公式編輯器...)
User ->> Frontend: 修改並點擊「保存」
Frontend ->> Backend: POST /api/system/asset-setting/update-asset-setting/ (Event Sourcing)
Frontend ->> Backend: POST /api/system/approval/ (建置 approval domain, 從 Event Sourcing 取得 ISMS 設定資料)
Backend ->> Database: 寫入 isms_setting 及 approval 資料
Approval ->> Database: 更新 isms_setting 資料，並觸發重新計算所有風險
Approval-->>Backend: 核准成功
Backend -->> Frontend: 回傳成功訊息
@enduml
